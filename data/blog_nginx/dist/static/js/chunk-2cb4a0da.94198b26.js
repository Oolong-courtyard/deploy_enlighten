(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2cb4a0da"],{"0b3d":function(e,t,r){"use strict";var o=r("d1eb"),s=r.n(o);s.a},"2aa4":function(e,t,r){e.exports=r.p+"static/img/weChatLogin.7530ebce.jpg"},"2ea1":function(e,t,r){e.exports=r.p+"static/img/qqLogin.d1c9deec.jpg"},cb71:function(e,t,r){e.exports=r.p+"static/img/githubLogin.d154193b.jpg"},d1eb:function(e,t,r){},f272:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"tabBarDiv"},[o("el-menu",{staticClass:"el-menu-demo",attrs:{mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b",router:""}},[o("div",{staticStyle:{display:"flex",border:"none",outline:"none"}},[o("div",{staticStyle:{display:"flex"}},[o("img",{staticStyle:{height:"60px",width:"60px","border-radius":"15px"},attrs:{src:r("f4c1"),alt:""}}),o("el-menu-item",{staticStyle:{"font-size":"20px",transform:"rotate(-10deg)","border-radius":"15px"},attrs:{index:""}},[e._v("enlighten\n          ")]),o("el-menu-item",{staticStyle:{"font-size":"15px"},attrs:{index:"index"}},[e._v("首页")]),o("el-menu-item",{attrs:{index:"myPublish"}},[e._v("历程")]),o("el-menu-item",[e._v("项目")])],1),o("div",{staticStyle:{display:"flex","margin-left":"100px","line-height":"50px","text-align":"center"}},[o("el-input",{staticStyle:{"font-size":"15px",padding:"5px",height:"30px",outline:"none"},attrs:{placeholder:"搜你所想"},on:{focus:e.searchFocus,blur:e.searchBlur,change:e.searchInputChange},model:{value:e.searchInput,callback:function(t){e.searchInput=t},expression:"searchInput"}},[o("i",{staticClass:"el-input__icon el-icon-search",style:{color:this.selectSearch?"#4096EF":"grey"},attrs:{slot:"suffix"},on:{click:function(t){e.startSearch(e.searchInput)}},slot:"suffix"})])],1),o("div",{staticStyle:{"margin-left":"50px"}},[o("el-menu-item",{attrs:{index:"article-publish"}},[e._v("写文章")])],1),o("div",{staticClass:"navLoginRegister",style:{display:this.loginSuccess?"none":"flex"}},[o("el-menu-item",{on:{click:function(t){e.loginDialogFormVisible=!0}}},[e._v("登录")]),o("el-menu-item",{on:{click:function(t){e.registerDialogFormVisible=!0}}},[e._v("注册\n          ")])],1),o("div",{staticClass:"loginSuccessUser",style:{display:this.loginSuccess?"flex":"none"}},[o("el-dropdown",{attrs:{trigger:"click"},on:{command:e.handleCommand}},[o("el-menu-item",[o("img",{staticStyle:{height:"36px",width:"36px","border-radius":"50px"},attrs:{src:e.userProfilePhoto}})]),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{command:"a"}},[e._v("个人中心")]),o("el-dropdown-item",{attrs:{command:"b"}},[e._v("购物车")]),o("el-dropdown-item",{attrs:{command:"c"}},[e._v("退出登录")])],1)],1)],1)])]),o("el-dialog",{staticClass:"loginElDialog",style:{height:this.otherLoginVisible?"590px":"550px"},attrs:{title:"账密登录",visible:e.loginDialogFormVisible,"close-on-click-modal":!1,"modal-append-to-body":!1,"append-to-body":!0},on:{"update:visible":function(t){e.loginDialogFormVisible=t}}},[o("template",{slot:"title"},[o("div",{staticStyle:{"font-weight":"bold","font-size":"18px"}},[e._v("账密登录")])]),o("el-form",{ref:"loginFormF",attrs:{model:e.loginForm,rules:e.loginFormRules}},[o("el-form-item",{attrs:{prop:"username",label:"用户名","label-width":e.formLabelWidth}},[o("el-input",{model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}})],1),o("el-form-item",{attrs:{prop:"password",label:"密码","label-width":e.formLabelWidth}},[o("el-input",{attrs:{type:"password"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:""},slot:"default"},[o("el-button",{staticStyle:{"margin-left":"125px"},attrs:{type:"primary"},on:{click:e.handleLogin}},[e._v("登录\n        ")]),o("el-button",{on:{click:function(t){e.resetForm("loginFormF")}}},[e._v("重置")])],1),o("hr",{staticStyle:{height:"1px",border:"none","border-top":"1px solid #555555","margin-top":"15px"}}),o("div",{staticClass:"otherLoginStyle",staticStyle:{"margin-top":"10px","margin-bottom":"15px","font-size":"14px",color:"#409EFF"},on:{click:e.otherLogin}},[e._v("\n        其他登录方式\n      ")]),o("div",{staticClass:"weChatAndOther",style:{display:this.otherLoginVisible?"flex":"none"}},[o("div",{staticClass:"otherLoginDivStyle",on:{click:e.qqLogin}},[o("img",{staticClass:"otherLoginItemStyle",attrs:{src:r("2ea1"),alt:""}})]),o("div",{staticClass:"otherLoginDivStyle",on:{click:e.weChatLogin}},[o("img",{staticClass:"otherLoginItemStyle",staticStyle:{height:"20px","margin-top":"10px"},attrs:{src:r("2aa4"),alt:""}})]),o("div",{staticClass:"otherLoginDivStyle",on:{click:e.githubLogin}},[o("img",{staticClass:"otherLoginItemStyle",staticStyle:{height:"20px","margin-top":"10px"},attrs:{src:r("cb71"),alt:""}})])]),o("div",{staticStyle:{"font-size":"15px","text-align":"center"}},[e._v("登录即表示同意\n        "),o("span",{staticClass:"userPolicy",staticStyle:{color:"#409EFF"}},[e._v("用户协议及隐私政策")])])],2),o("el-dialog",{staticClass:"registerElDialog",attrs:{title:"注册",visible:e.registerDialogFormVisible,"close-on-click-modal":!1,"modal-append-to-body":!1,"append-to-body":!0},on:{"update:visible":function(t){e.registerDialogFormVisible=t}}},[o("el-form",{ref:"registerFormF",attrs:{model:e.registerForm,rules:e.registerFormRules}},[o("el-form-item",{attrs:{prop:"username",label:"用户名","label-width":e.formLabelWidth}},[o("el-input",{on:{blur:e.CheckUsernameExist},model:{value:e.registerForm.username,callback:function(t){e.$set(e.registerForm,"username",t)},expression:"registerForm.username"}})],1),o("div",{staticStyle:{display:"flex"}},[o("el-form-item",{attrs:{prop:"mobile",label:"手机号","label-width":e.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"on"},model:{value:e.registerForm.mobile,callback:function(t){e.$set(e.registerForm,"mobile",t)},expression:"registerForm.mobile"}})],1)],1),o("div",{staticStyle:{display:"flex"}},[o("el-form-item",{attrs:{prop:"verification",label:"","label-width":e.formLabelWidth}},[o("el-input",{attrs:{autocomplete:"on"},model:{value:e.registerForm.verification,callback:function(t){e.$set(e.registerForm,"verification",t)},expression:"registerForm.verification"}})],1),o("button",{directives:[{name:"show",rawName:"v-show",value:e.smsCodeShow,expression:"smsCodeShow"}],staticClass:"getVerifyCodeStyle",staticStyle:{"border-radius":"5px",width:"102px",height:"40px","margin-left":"10px","border-style":"none","background-color":"#409EFF",color:"white",outline:"none"},attrs:{type:"button"},on:{click:e.getVerifyCode}},[e._v("获取验证码\n          ")]),o("button",{directives:[{name:"show",rawName:"v-show",value:!e.smsCodeShow,expression:"!smsCodeShow"}],staticClass:"countDownVerifyCodeStyle",attrs:{type:"button"}},[e._v(e._s(e.countDown)+"\n          ")])],1),o("el-form-item",{attrs:{prop:"password",label:"密码","label-width":e.formLabelWidth}},[o("el-input",{attrs:{type:"password"},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password",t)},expression:"registerForm.password"}})],1),o("el-form-item",{attrs:{prop:"ensurePassword",label:"确认密码","label-width":e.formLabelWidth}},[o("el-input",{attrs:{type:"password"},model:{value:e.registerForm.ensurePassword,callback:function(t){e.$set(e.registerForm,"ensurePassword",t)},expression:"registerForm.ensurePassword"}})],1)],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:e.handleRegister}},[e._v("注册")]),o("el-button",{on:{click:function(t){e.resetForm("registerFormF")}}},[e._v("重置")])],1)],1)],1)},s=[],i=(r("96cf"),r("3b8d")),a=(r("8f0e"),{name:"NavBar",data:function(){var e=this,t=function(t,r,o){var s=/^[a-z0-9]*$/;s.test(e.loginForm.username)?o():o(new Error("用户名不存在"))},r=function(t,r,o){var s=/^[a-z0-9]*$/;s.test(e.loginForm.password)?o():o(new Error("密码错误"))},o=function(t,r,o){var s=/^[a-z0-9]*$/;s.test(e.registerForm.username)||o(new Error("用户名只能包含数字或字母")),!0===e.usernameExist&&o(new Error("用户名已存在"))},s=function(t,r,o){var s=/^1[3-9]\d{9}$/;s.test(e.registerForm.mobile)||o(new Error("手机号格式错误"))},i=function(t,r,o){var s=/^[a-z0-9]*$/;s.test(e.registerForm.password)?o():o(new Error("密码只能包含数字或字母"))},a=function(t,r,o){e.registerForm.password!==e.registerForm.ensurePassword?o(new Error("密码不一致")):o()};return{selectSearch:!1,searchInput:"",searchInputValueChange:!1,canLogin:!0,canRegister:!0,username:null,userProfilePhoto:null,usernameExist:!1,loginSuccess:!1,otherLoginVisible:!1,registerVerifyFormVisible:!1,loginDialogFormVisible:!1,registerDialogFormVisible:!1,smsCodeShow:!0,countDown:"",timer:null,loginForm:{username:"",password:""},registerForm:{username:"",mobile:"",verification:"",password:"",ensurePassword:""},loginFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:11,message:"用户名不存在",trigger:"blur"},{validator:t,trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:5,max:11,message:"密码错误",trigger:"blur"},{validator:r,trigger:"blur"}]},registerFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:11,message:"长度必须在5到15个字符之间",trigger:"blur"},{validator:o,trigger:"blur"}],mobile:[{message:"请输入手机号码",trigger:"blur"},{len:11,message:"大陆手机号长度必须为11位",trigger:"blur"},{validator:s,trigger:"blur"}],verification:[{required:!0,message:"验证码",trigger:"blur"},{min:6,max:6,message:"长度必须为6个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:5,max:11,message:"长度必须在5到15个字符之间",trigger:"blur"},{validator:i,trigger:"blur"}],ensurePassword:[{required:!0,message:"请输入密码确认",trigger:"blur"},{validator:a,trigger:"blur"}]},formLabelWidth:"80px"}},mounted:function(){var e=localStorage.getItem("username");null!=e?(this.loginSuccess=!0,this.username=e,this.userProfilePhoto=localStorage.getItem("userProfilePhoto")):this.loginSuccess=!1},methods:{startSearch:function(){var e=this;!1!==this.searchInputValueChange?(this.selectSearch=!0,this.$http.get(this.$articleSearch,{params:{articleName:this.searchInput,page:1}}).then(function(t){console.log("请求到的数据为",t),e.$emit("child-event",{resData:t.data.data,pageNum:1,searchInput:e.searchInput})}).catch(function(e){console.log("响应异常了",e)})):console.log("输入框值未改变,不发送请求")},searchBlur:function(){this.selectSearch=!1},searchFocus:function(){this.selectSearch=!0},searchInputChange:function(){this.searchInputValueChange=!0},checkRegisterUsername:function(){},CheckUsernameExist:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log("失去焦点出发了"),this.$http.get(this.$usernameCountUrl,{params:{username:this.registerForm.username}}).then(function(e){console.log("用户名不存在，可以注册"),t.usernameExist=!1}).catch(function(e){400===e.response.status&&(t.usernameExist=!0)});case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleCommand:function(e){"c"===e&&(this.loginSuccess=!1,localStorage.clear(),location.reload())},qqLogin:function(){console.log("qq登录"),this.$http.get(this.$qqAuthorizationUrl).then(function(e){console.log("请求获取到的qq登录的url为",e),console.log("res.data.login_url为",e.data.login_url),window.open(e.data.login_url)})},weChatLogin:function(){console.log("微信登录")},githubLogin:function(){console.log("github登录")},otherLogin:function(){this.otherLoginVisible=!this.otherLoginVisible},verifyMobile:function(){11===this.registerForm.mobile.len?this.registerVerifyFormVisible=!0:this.$message({message:"大陆手机号必须为11位",type:"warning"})},getVerifyCode:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=/^1[3-9]\d{9}$/,t.test(this.registerForm.mobile)||callback(new Error("请输入正确的手机号")),this.$http.get(this.$phoneCount,{params:{phone:this.registerForm.mobile}}).then(function(e){r.$message({message:"获取验证码请求已发出"});var t=60;r.timer||(r.countDown=t,r.smsCodeShow=!1,r.timer=setInterval(function(){r.countDown>0&&r.countDown<=t?r.countDown--:(r.smsCodeShow=!0,clearInterval(r.timer),r.timer=null)},1e3)),r.$http.get(r.$getSmsCode,{params:{phone:r.registerForm.mobile}}).then(function(e){console.log("获取验证码得到的res是",e)}).catch(function(e){console.log("获取验证码得到的err是",e)})}).catch(function(e){r.$message({message:"手机号已注册",type:"warning"})});case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),resetForm:function(e){this.$refs[e].resetFields()},handleLogin:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.$refs.loginFormF.validate(function(e){t.canLogin=e}),!1!==this.canLogin){e.next=3;break}return e.abrupt("return");case 3:this.$http.post(this.$userLoginUrl,this.loginForm,{headers:{"content-type":"application/x-www-form-urlencoded"}}).then(function(e){console.log("登录成功"),t.loginDialogFormVisible=!1,t.loginSuccess=!0,t.username=e.data.data["username"],localStorage.setItem("userId",e.data.data["user_id"]),localStorage.setItem("username",e.data.data["username"]),localStorage.setItem("userToken",e.data.data["token"]),localStorage.setItem("userProfilePhoto",e.data.data["profile_photo"]),t.$http.get(t.$getStarCount,{headers:{"x-token":localStorage.getItem("userToken")},params:{user_id:localStorage.getItem("userId")}}).then(function(e){localStorage.setItem("userArticleStars",e.data.data),location.reload()}).catch(function(e){}),null!=localStorage.getItem("userToken")&&console.log("用户已登录")}).catch(function(e){console.log("error是",e),400===e.response.status&&t.$message({message:"用户名或密码错误",type:"warning"})});case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleRegister:function(){var e=this;console.log("来到了handleRegister"),this.$refs.registerFormF.validate(function(t){e.canRegister=t}),!1!==this.canRegister?this.$http.post(this.$userRegisterUrl,{username:this.registerForm.username,phone:this.registerForm.mobile,sms_code:this.registerForm.verification,password:this.registerForm.password,ensure_password:this.registerForm.ensurePassword}).then(function(t){console.log("注册成功的res为",t),e.$message({message:"注册成功",type:"warning"}),e.registerDialogFormVisible=!1,e.loginSuccess=!0,e.username=e.registerForm.username,localStorage.setItem("userId",t.data.data["user_id"]),localStorage.setItem("username",t.data.data["username"]),localStorage.setItem("userToken",t.data.data["token"]),localStorage.setItem("userArticleStars",""),location.reload()}).catch(function(t){console.log("注册失败的err为",t.response.data),e.$message({message:t.response.data.detail,type:"warning"})}):console.log("表单校验",this.canRegister)}}}),n=a,l=(r("0b3d"),r("2877")),c=Object(l["a"])(n,o,s,!1,null,null,null);c.options.__file="NavBar.vue";t["default"]=c.exports},f4c1:function(e,t,r){e.exports=r.p+"static/img/login_head.1f452ba3.jpg"}}]);